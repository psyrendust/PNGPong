/*
 * pngpong is (c) 2007 Larry Lenn Gordon and is released under the MIT License:
 * http://www.opensource.org/licenses/mit-license.php
 * 
 * @projectDescription	pngpong: Method to allow the support for transparent
 *                     images in IE by replacing PNG's with PNG embeded swf's. 
 * 
 * @author   Larry Lenn Gordon : Jan 25, 2007 - http://blog.psyrendust.com/pngpong/
 * @version  1.0.0
 */
if(pngpong=="undefined"){var pngpong=new Object()}pngpong={swfLocation:function(){return"/pngpong/pngpong.swf"},serve:function(b,a){pngpong.util.addpng(b,"",a)},serveButtonUrl:function(c,d,a,b){pngpong.util.addpngButtonUrl(c,"",d,a,b)},serveButtonJs:function(d,e,a,b,c){pngpong.util.addpngButtonJs(d,"",e,a,b,c)},swapImage:function(b,a){try{if(navigator.appVersion.indexOf("Win")&&navigator.appName=="Microsoft Internet Explorer"&&pngpong.util.checkIfPng(a)){pngpong.util.getNode(b+"_swf").swapImage(a)}else{pngpong.util.swapImage(b+"_img",a)}}catch(c){}}};pngpong.alt={serve:function(c,a,b){pngpong.util.addpng(c,a,b)},serveButtonUrl:function(d,b,e,a,c){pngpong.util.addpngButtonUrl(d,b,e,a,c)},serveButtonJs:function(e,c,f,a,b,d){pngpong.util.addpngButtonJs(e,c,f,a,b,d)}};pngpong.util={imgArray:Array(),getNode:function(b){try{if(window.document[b]){return window.document[b]}if(navigator.appName.indexOf("Microsoft Internet")==-1){if(document.embeds&&document.embeds[b]){return document.embeds[b]}else{return document.getElementById(b)}}else{return document.getElementById(b)}}catch(a){}},setPngpongWH:function(d,g,a){try{var b=pngpong.util.getNode(d);b.style.width=g+"px";b.style.height=a+"px";var f=pngpong.util.getNode(d+"_swf");f.style.width=g+"px";f.style.height=a+"px";delete b;delete f}catch(c){}},addpng:function(c,a,b){pngpong.util.preloadImage(pngpong.util.getName(b));if(navigator.appVersion.indexOf("Win")&&navigator.appName=="Microsoft Internet Explorer"&&pngpong.util.checkIfPng(b)){try{var f=new SWFObject(pngpong.swfLocation(),c+"_swf","100%","100%","8","#ffffff",false,"high");f.addParam("wmode","transparent");f.addVariable("swfType","image");f.addVariable("pngloc",pngpong.util.getName(b));f.addVariable("divName",c);f.write(c)}catch(d){}}else{try{var g=pngpong.util.getNode(c);g.style.visibility="hidden";g.innerHTML='<img alt="'+a+'" id="'+c+'_img" name="'+c+'_img" onload="pngpong.util.show(\''+c+'\');" style="visibility:hidden;" src="'+pngpong.util.getName(b)+'" border="0" />'}catch(d){}}},addpngButtonUrl:function(d,b,i,a,c){pngpong.util.preloadImage(pngpong.util.getName(i));pngpong.util.preloadImage(pngpong.util.getName(a));if(navigator.appVersion.indexOf("Win")&&navigator.appName=="Microsoft Internet Explorer"&&pngpong.util.checkIfPng(i)&&pngpong.util.checkIfPng(a)){try{var g=new SWFObject(pngpong.swfLocation(),d+"_swf","100%","100%","8","#ffffff",false,"high");g.addParam("wmode","transparent");g.addVariable("swfType","button_url");g.addVariable("pnglocOut",pngpong.util.getName(i));g.addVariable("pnglocOver",pngpong.util.getName(a));g.addVariable("action",c);g.addVariable("divName",d);g.write(d)}catch(f){}}else{try{var h=pngpong.util.getNode(d);h.style.visibility="hidden";if(c==""||c=="null"||c=="undefined"){h.innerHTML='<img alt="'+b+'" id="'+d+'_img" name="'+d+'_img" onload="pngpong.util.show(\''+d+'\');" style=" cursor:pointer; cursor:hand;" src="'+pngpong.util.getName(i)+'" onMouseOver="pngpong.util.swapImage(\''+d+"_img', '"+pngpong.util.getName(a)+"');\" onMouseOut=\"pngpong.util.swapImage('"+d+"_img', '"+pngpong.util.getName(i)+'\');" border="0" />'}else{h.innerHTML='<img alt="'+b+'" id="'+d+'_img" name="'+d+'_img" onload="pngpong.util.show(\''+d+'\');" style=" cursor:pointer; cursor:hand;" src="'+pngpong.util.getName(i)+'" onMouseOver="pngpong.util.swapImage(\''+d+"_img', '"+pngpong.util.getName(a)+"');\" onMouseOut=\"pngpong.util.swapImage('"+d+"_img', '"+pngpong.util.getName(i)+"');\" onMouseDown=\"window.location='"+c+'\'" border="0" />'}}catch(f){}}},addpngButtonJs:function(h,f,d,i,j,c){pngpong.util.preloadImage(pngpong.util.getName(d));pngpong.util.preloadImage(pngpong.util.getName(i));if(navigator.appVersion.indexOf("Win")&&navigator.appName=="Microsoft Internet Explorer"&&pngpong.util.checkIfPng(d)&&pngpong.util.checkIfPng(i)){try{var b=new SWFObject(pngpong.swfLocation(),h+"_swf","100%","100%","8","#ffffff",false,"high");b.addParam("wmode","transparent");b.addVariable("swfType","button_js");b.addVariable("pnglocOut",pngpong.util.getName(d));b.addVariable("pnglocOver",pngpong.util.getName(i));b.addVariable("action",j);b.addVariable("parameters",c);b.addVariable("divName",h);b.write(h)}catch(g){}}else{try{var a=pngpong.util.getNode(h);a.style.visibility="hidden";if(j==""||j=="null"||j=="undefined"){a.innerHTML='<img alt="'+f+'" id="'+h+'_img" name="'+h+'_img" onload="pngpong.util.show(\''+h+'\');" style="cursor:pointer; cursor:hand;" src="'+pngpong.util.getName(d)+'" onMouseOver="pngpong.util.swapImage(\''+h+"_img', '"+pngpong.util.getName(i)+"');\" onMouseOut=\"pngpong.util.swapImage('"+h+"_img', '"+pngpong.util.getName(d)+'\');" border="0" />'}else{a.innerHTML='<img alt="'+f+'" id="'+h+'_img" name="'+h+'_img" onload="pngpong.util.show(\''+h+'\');" style="cursor:pointer; cursor:hand;" src="'+pngpong.util.getName(d)+'" onMouseOver="pngpong.util.swapImage(\''+h+"_img', '"+pngpong.util.getName(i)+"');\" onMouseOut=\"pngpong.util.swapImage('"+h+"_img', '"+pngpong.util.getName(d)+"');\" onMouseDown=\"pngpong.util.swapImage('"+h+"_img', '"+pngpong.util.getName(d)+"'); "+j+"('"+c+'\');" border="0" />'}}catch(g){}}},getName:function(c){var a=c.split("/");var b=a[a.length-1].split(".")[1];if(b==undefined){return c+".png"}else{return c}},checkIfPng:function(c){var a=pngpong.util.getName(c).split("/");var b=a[a.length-1].split(".")[1];if(b=="png"){return true}else{return false}},preloadImage:function(a){try{pngpong.util.imgArray.push(new Image());pngpong.util.imgArray[pngpong.util.imgArray.length-1].src=a}catch(b){}},swapImage:function(b,a){try{document[b].src=a}catch(c){}},show:function(a){try{pngpong.util.getNode(a).style.visibility="visible";pngpong.util.getNode(a+"_img").style.visibility="visible"}catch(b){}}};