/*
 * pngpong is (c) 2007-2008 Larry Lenn Gordon and is released under the MIT License:
 * http://www.opensource.org/licenses/mit-license.php
 * 
 * @description	pngpong: Method to allow the support for transparent
 *               images in IE by replacing PNG's with PNG embeded swf's. 
 * 
 * @author   Larry Lenn Gordon : Jan 25, 2007 - http://blog.psyrendust.com/pngpong/
 * @version  1.1.0
 */
if(pngpong=="undefined"){var pngpong=new Object()}pngpong={loc:String(),setLocation:function(b){var a=b.length-1;var c=b.charAt(a);pngpong.loc=b;if(c!="/"){pngpong.loc+="/"}},swfLocation:function(){return pngpong.loc+"pngpong.swf"},defaultImage:function(){return pngpong.loc+"noFlash.gif"},swapImage:function(a,b){try{if(pngpong.util.writeSwf&&pngpong.util.checkIfPng(b)){pngpong.util.getNode(a+"_swf").swapImage(b)}else{pngpong.util.swapImage(a+"_img",b)}}catch(c){}},alpha:function(a,b){try{if(pngpong.util.writeSwf){pngpong.util.getNode(a+"_swf").setAlpha(b)}else{pngpong.util.setAlpha(a,b)}}catch(c){}},enabled:function(b,a){try{if(pngpong.util.writeSwf){pngpong.util.getNode(b+"_swf").setEnabled(a)}else{pngpong.util.setEnabled(b+"_img",a)}}catch(c){}},serve:function($target,$vars){if(pngpong.util.writeSwf&&pngpong.util.checkIfPng($vars.out)){var swfNode="";var pairs="";var vars=new Array();swfNode='<object id="'+$target+'_swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%" >';swfNode+='<param name="menu" value="false" />';swfNode+='<param name="quality" value="high" />';swfNode+='<param name="allowScriptAccess" value="always" />';swfNode+='<param name="movie" value="'+pngpong.swfLocation()+'" />';if($vars.out!=undefined){vars.push("$out="+pngpong.util.getName($vars.out))}if($vars.over!=undefined){vars.push("$over="+pngpong.util.getName($vars.over))}if($vars.down!=undefined){vars.push("$down="+pngpong.util.getName($vars.down))}if($vars.url!=undefined){vars.push("$url="+$vars.url)}if($vars.browserTarget!=undefined){vars.push("$browserTarget="+$vars.browserTarget)}if($vars.method!=undefined){vars.push("$method="+$vars.method)}if($vars.params!=undefined){vars.push("$params="+$vars.params)}swfNode+='<param name="wmode" value="transparent" />';pairs=vars.join("&");if(vars.length>0){swfNode+='<param name="flashvars" value="'+pairs+'" />'}swfNode+="</object>";pngpong.util.getNode($target).innerHTML=swfNode}else{try{var attachEvents=false;var div=pngpong.util.getNode($target);div.style.visibility="hidden";var image=document.createElement("img");image.setAttribute("id",$target+"_img");image.setAttribute("name",$target+"_img");image.setAttribute("style","visibility:hidden");image.setAttribute("border","0");if(pngpong.util.browserIsIE&&pngpong.util.checkIfPng($vars.out)&&$vars.altImg==undefined){image.setAttribute("src",pngpong.defaultImage())}else{if(pngpong.util.browserIsIE&&$vars.altImg!=undefined){image.setAttribute("src",pngpong.util.getName($vars.altImg));attachEvents=true}else{if($vars.out==undefined){image.setAttribute("src",pngpong.defaultImage())}else{image.setAttribute("src",pngpong.util.getName($vars.out));attachEvents=true}}}if(attachEvents){var imgName=$target+"_img";if($vars.over!=undefined){image.setAttribute("style","visibility:hidden; cursor:pointer; cursor:hand;");pngpong.util.preloadImage(pngpong.util.getName($vars.over));image.onmouseover=function(){pngpong.util.swapImage(imgName,pngpong.util.getName($vars.over))};image.onmouseout=function(){pngpong.util.swapImage(imgName,pngpong.util.getName($vars.out))}}if($vars.down!=undefined){image.setAttribute("style","visibility:hidden; cursor:pointer; cursor:hand;");pngpong.util.preloadImage(pngpong.util.getName($vars.down));image.onmousedown=function(){pngpong.util.swapImage(imgName,pngpong.util.getName($vars.down))};image.onmouseup=function(){pngpong.util.swapImage(imgName,pngpong.util.getName($vars.over))}}if($vars.url!=undefined){image.setAttribute("style","visibility:hidden; cursor:pointer; cursor:hand;");image.onclick=function(){window.open($vars.url,(($vars.browserTarget!=undefined)?$vars.browserTarget:"_self"))}}if($vars.method!=undefined){image.setAttribute("style","visibility:hidden; cursor:pointer; cursor:hand;");image.onclick=function(){eval($vars.method).call(this,$vars.params)}}}if($vars.altName!=undefined){image.alt=$vars.altName}image.onload=function(){pngpong.util.show($target)};div.appendChild(image)}catch(e){alert(e)}}}};pngpong.util={imgArray:Array(),writeSwf:String(),browserIsIE:Boolean(),requiredVersion:Array(),init:function(){pngpong.setLocation("../");pngpong.util.setBrowser();if(pngpong.util.browserIsIE){pngpong.util.requiredVersion=[8,0,0];pngpong.util.writeSwf=pngpong.util.isPlayerVersionValid(pngpong.util.requiredVersion)}},getPlayerVersion:function(){var c=[0,0,0];var d;if(navigator.plugins&&navigator.mimeTypes.length){var a=navigator.plugins["Shockwave Flash"];if(a&&a.description){c=a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".")}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){d=1;var b=3;while(d){try{b++;d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+b);c=[b,0,0]}catch(f){d=null}}}else{try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(f){try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");c=[6,0,21];d.AllowScriptAccess="always"}catch(f){if(c[0]==6){return c}}try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(f){}}if(d!=null){c=d.GetVariable("$version").split(" ")[1].split(",")}}}return c},isPlayerVersionValid:function(b){var a=pngpong.util.getPlayerVersion();if(a[0]<b[0]){return false}if(a[0]>b[0]){return true}if(a[1]<b[1]){return false}if(a[1]>b[1]){return true}if(a[2]<b[2]){return false}return true},getPlayerVersionString:function(){return pngpong.util.getPlayerVersion().join(".")},getNode:function(b){try{if(window.document[b]){return window.document[b]}if(navigator.appName.indexOf("Microsoft Internet")==-1){if(document.embeds&&document.embeds[b]){return document.embeds[b]}else{return document.getElementById(b)}}else{return document.getElementById(b)}}catch(a){}},setPngpongWH:function(d,g,a){try{var b=pngpong.util.getNode(d);b.style.width=g+"px";b.style.height=a+"px";var f=pngpong.util.getNode(d+"_swf");f.style.width=g+"px";f.style.height=a+"px";delete b;delete f}catch(c){}},getName:function(c){var a=c.split("/");var b=a[a.length-1].split(".")[1];if(b==undefined){return c+".png"}else{return c}},setBrowser:function(){pngpong.util.browserIsIE=(navigator.appVersion.indexOf("Win")&&navigator.appName=="Microsoft Internet Explorer")?true:false},checkIfPng:function(c){var a=pngpong.util.getName(c).split("/");var b=a[a.length-1].split(".")[1];if(b=="png"){return true}else{return false}},preloadImage:function(a){try{pngpong.util.imgArray.push(new Image());pngpong.util.imgArray[pngpong.util.imgArray.length-1].src=a}catch(b){}},swapImage:function(a,b){try{document[a].src=b}catch(c){}},show:function(a){try{pngpong.util.getNode(a).style.visibility="visible";pngpong.util.getNode(a+"_img").style.visibility="visible"}catch(b){}},setAlpha:function(a,b){try{pngpong.util.getNode(a).style.filter="alpha(opacity="+b+")";pngpong.util.getNode(a).style["-moz-opacity"]=b/100;pngpong.util.getNode(a).style.opacity=b/100}catch(c){alert(c)}},setEnabled:function(a,b){}};pngpong.util.init();